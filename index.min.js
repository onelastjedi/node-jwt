var f=require("node:crypto"),u=(e,a)=>r=>r.replace(e,a),h=u(/=/g,""),y=e=>e.split("."),l=(e,a)=>r=>r.slice(e,a),b=e=>[l(0,2)(e),l(2)(e)],p=e=>h(btoa(x(e))),d=e=>D(atob(e)),w=e=>e/1e3,s=e=>Math.floor(w(e.now())),S=e=>s(Date)+e,x=JSON.stringify,D=JSON.parse,H=e=>a=>r=>f.createHmac(e,a).update(r).digest("base64url"),v=e=>{var[a,r]=b(e);return{HS:i=>H("sha"+i)}[a](r)},J=e=>p({alg:e,typ:"JWT"});function $({exp:e,...a},r,i="HS256"){var t=J(i),n=p({...a,iat:s(Date),...e&&{exp:S(e)}}),o=v(i)(r);return`${t}.${n}.${o(t+"."+n)}`}function E(e,a){var[r,i,t]=y(e),{alg:n}=d(r),o=v(n)(a),c=t!==o(r+"."+i),g=d(i).exp<=s(Date);if(c)throw new Error("Invalid signature");if(g)throw new Error("Token expired");return{...d(i)}}module.exports={sign:$,verify:E};
